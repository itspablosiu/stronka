<div id="spotify-tile" class="tile big-tile" style="display: none; align-items: flex-start; text-align: left;">
    <div style="display: flex; gap: 15px; align-items: center; width: 100%;">
        <img id="spotify-album" src="" style="width: 60px; height: 60px; border-radius: 12px; box-shadow: 0 10px 20px rgba(0,0,0,0.3);">
        <div style="overflow: hidden;">
            <p style="color: #1DB954; font-weight: 800; font-size: 10px; text-transform: uppercase; margin: 0;">Słucham teraz</p>
            <h2 id="spotify-title" style="font-size: 16px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Utwór</h2>
            <p id="spotify-artist" style="font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Wykonawca</p>
        </div>
    </div>
    <div style="width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; margin-top: 15px;">
        <div id="spotify-progress" style="width: 0%; height: 100%; background: #1DB954; border-radius: 2px; transition: width 1s linear;"></div>
    </div>
</div>

<script>
    // TWOJE ID DISCORD - Zmień na swoje!
    const DISCORD_ID = "TWÓJ_ID_DISCORD_TUTAJ"; 

    async function fetchStatus() {
        try {
            const response = await fetch(`https://api.lanyard.rest/v1/users/${DISCORD_ID}`);
            const data = await response.json();
            const status = data.data;

            // 1. Obsługa Statusu Discord (Kropka na awatarze)
            const avatarImg = document.querySelector('.avatar');
            const statusColors = { online: '#43b581', idle: '#faa61a', dnd: '#f04747', offline: '#747f8d' };
            avatarImg.style.borderColor = statusColors[status.discord_status] || statusColors.offline;

            // 2. Obsługa Spotify
            const spotifyTile = document.getElementById('spotify-tile');
            if (status.listening_to_spotify) {
                spotifyTile.style.display = 'flex';
                document.getElementById('spotify-album').src = status.spotify.album_art_url;
                document.getElementById('spotify-title').innerText = status.spotify.track;
                document.getElementById('spotify-artist').innerText = status.spotify.artist;

                // Obliczanie paska postępu
                const start = status.spotify.timestamps.start;
                const end = status.spotify.timestamps.end;
                const now = Date.now();
                const progress = ((now - start) / (end - start)) * 100;
                document.getElementById('spotify-progress').style.width = Math.min(progress, 100) + "%";
            } else {
                spotifyTile.style.display = 'none'; // Ukryj jeśli nie słuchasz
            }
        } catch (err) {
            console.error("Lanyard Error:", err);
        }
    }

    // Odświeżaj co 3 sekundy
    setInterval(fetchStatus, 3000);
    fetchStatus();
</script>
